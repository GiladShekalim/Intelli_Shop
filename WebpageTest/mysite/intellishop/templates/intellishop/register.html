{% extends 'intellishop/index_home_original.html' %}
{% load static %}

{% block content %}
<!-- Registration Form Section -->
<section class="py-5" style="background-color: #f8f9fa;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-7">
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-4">
                        <h2 class="text-center mb-4">Register</h2>
                        <form id="registerForm">
                            {% csrf_token %}
                            <div class="mb-3 row">
                                <label for="username" class="col-sm-3 col-form-label">Username:</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="username" name="username" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="password" class="col-sm-3 col-form-label">Password:</label>
                                <div class="col-sm-9">
                                    <input type="password" class="form-control" id="password" name="password" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="email" class="col-sm-3 col-form-label">Email:</label>
                                <div class="col-sm-9">
                                    <input type="email" class="form-control" id="email" name="email" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="status" class="col-sm-3 col-form-label">Status:</label>
                                <div class="col-sm-9">
                                    <div class="d-flex flex-wrap gap-2">
                                        <input type="checkbox" class="btn-check status-checkbox" id="status-young" value="Young" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-primary rounded-pill" for="status-young">Young</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-senior" value="Senior" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-success rounded-pill" for="status-senior">Senior</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-homeowner" value="Homeowner" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="status-homeowner">Homeowner</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-traveler" value="Traveler" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-info rounded-pill" for="status-traveler">Traveler</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-tech" value="Tech" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-warning rounded-pill" for="status-tech">Tech</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-pets" value="Pets" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-danger rounded-pill" for="status-pets">Pets</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-fitness" value="Fitness" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-primary rounded-pill" for="status-fitness">Fitness</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-student" value="Student" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-success rounded-pill" for="status-student">Student</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-remote" value="Remote" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-dark rounded-pill" for="status-remote">Remote</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-family" value="Family" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-warning rounded-pill" for="status-family">Family</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="age" class="col-sm-3 col-form-label">Age:</label>
                                <div class="col-sm-9">
                                    <input type="number" class="form-control" id="age" name="age" min="18" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="location" class="col-sm-3 col-form-label">Location:</label>
                                <div class="col-sm-9">
                                    <select class="form-select" id="location" name="location" required>
                                        <option value="">Select location</option>
                                        <option value="newyork">New York</option>
                                        <option value="sydney">Sydney</option>
                                        <option value="london">London</option>
                                        <option value="mumbai">Mumbai</option>
                                        <option value="toronto">Toronto</option>
                                        <option value="dubai">Dubai</option>
                                        <option value="hongkong">Hong Kong</option>
                                        <option value="shanghai">Shanghai</option>
                                        <option value="israel">Israel</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="hobbies" class="col-sm-3 col-form-label">Hobbies:</label>
                                <div class="col-sm-9">
                                    <div class="d-flex flex-wrap gap-2">
                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-consumerism" value="Consumerism" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="hobby-consumerism">Consumerism</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-travel" value="Travel and Vacation" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="hobby-travel">Travel and Vacation</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-culture" value="Culture and Leisure" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="hobby-culture">Culture and Leisure</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-cars" value="Cars" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="hobby-cars">Cars</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-insurance" value="Insurance" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="hobby-insurance">Insurance</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-finance" value="Finance and Banking" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="hobby-finance">Finance and Banking</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-grid mt-4">
                                <button type="submit" class="btn btn-danger">REGISTER</button>
                            </div>
                            
                            <div class="text-center mt-3">
                                <span>Already have an account? <a href="{% url 'login' %}" id="signin-link">SIGN IN</a></span>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.getElementById('registerForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Get all selected hobbies
    const selectedHobbies = Array.from(document.querySelectorAll('.hobby-checkbox:checked')).map(cb => cb.value);
    
    // Get all selected statuses
    const selectedStatuses = Array.from(document.querySelectorAll('.status-checkbox:checked')).map(cb => cb.value);
    
    // Create the data object
    const formData = {
        username: document.getElementById('username').value,
        password: document.getElementById('password').value,
        email: document.getElementById('email').value,
        status: selectedStatuses,  // Now sending array of statuses
        age: parseInt(document.getElementById('age').value),
        location: document.getElementById('location').value,
        hobbies: selectedHobbies
    };

    try {
        const response = await fetch('/register/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            },
            body: JSON.stringify(formData)
        });

        const data = await response.json();
        
        if (response.ok) {
            alert('Registration successful!');
            window.location.href = '/login/';  // Redirect to login page
        } else {
            alert('Error: ' + data.message);
        }
    } catch (error) {
        alert('Error: ' + error.message);
    }
});
</script>
{% endblock %}

<style>
.table {
    margin-top: 20px;
}

.table th {
    background-color: #f8f9fa;
}

.table-responsive {
    overflow-x: auto;
}

/* Status badge styles */
.status-badge {
    margin: 2px;
    font-size: 0.85em;
    padding: 5px 8px;
    color: white; /* Default text color for solid badges */
}

/* Hobby badge styles */
.hobby-badge {
    margin: 2px;
    font-size: 0.85em;
    padding: 5px 8px;
    color: white; /* Default text color for solid badges */
}

/* Custom colors for hobbies */
.bg-lifestyle {
    background-color: #20b2aa; /* LightSeaGreen */
}

.bg-electronics {
    background-color: #0dcaf0; /* Light Blue */
}

.bg-home {
    background-color: #ff6347; /* Tomato */
}

.bg-books {
    background-color: #4682b4; /* Steel Blue */
}

/* Additional status colors */
.bg-pink {
    background-color: #e83e8c;
}

.bg-purple {
    background-color: #6f42c1;
}

.bg-teal {
    background-color: #20c997;
}

/* New and updated status colors */
.bg-young {
    background-color: #007bff; /* Bright Blue */
}

.bg-senior {
    background-color: #28a745; /* Bright Green */
}

.bg-traveler {
    background-color: #17a2b8; /* Cyan */
}

.bg-tech {
    background-color: #ffc107; /* Yellow - might need black text */
    color: black;
}

.bg-pets {
    background-color: #dc3545; /* Red */
}

.bg-fitness {
    background-color: #fd7e14; /* Orange */
}

.bg-remote {
    background-color: #6610f2; /* Indigo */
}

.bg-family {
    background-color: #e83e8c; /* Pink */
}

.bg-retiree {
    background-color: #9acd32; /* YellowGreen */
}

.bg-single {
    background-color: #40e0d0; /* Turquoise - might need black text */
    color: black;
}

.bg-renter {
    background-color: #ff8c00; /* DarkOrange */
}

.bg-newlywed {
    background-color: #ba55d3; /* MediumOrchid */
}

.bg-military {
    background-color: #b22222; /* FireBrick */
}

.bg-entrepreneur {
    background-color: #f08080; /* LightCoral - might need black text */
    color: black;
}

.bg-unemployed {
    background-color: #c71585; /* MediumVioletRed */
}

.bg-caregiver {
    background-color: #daa520; /* Goldenrod - might need black text */
    color: black;
}

.bg-digitalnomad {
    background-color: #5f9ea0; /* CadetBlue */
}

.bg-firsttimebuyer {
    background-color: #d2691e; /* Chocolate */
}

.bg-emptynester {
    background-color: #6495ed; /* CornflowerBlue */
}

/* New and updated hobby colors */
.bg-consumerism {
    background-color: #4b0082; /* Indigo */
}

.bg-travel {
    background-color: #ff4500; /* OrangeRed */
}

.bg-culture {
    background-color: #00ffff; /* Aqua - might need black text */
    color: black;
}

.bg-cars {
    background-color: #7fff00; /* Chartreuse - might need black text */
    color: black;
}

.bg-insurance {
    background-color: #8a2be2; /* Blue Violet */
}

.bg-finance {
    background-color: #deb887; /* Burlywood - might need black text */
    color: black;
}

td {
    vertical-align: middle;
}

/* Apply solid background to labels on register page */
.btn-check:checked + .btn-outline-primary {
    background-color: #007bff;
    color: white;
    border-color: #007bff;
}

.btn-check:checked + .btn-outline-success {
    background-color: #28a745;
    color: white;
    border-color: #28a745;
}

.btn-check:checked + .btn-outline-secondary {
    background-color: #6c757d;
    color: white;
    border-color: #6c757d;
}

.btn-check:checked + .btn-outline-info {
    background-color: #17a2b8;
    color: white;
    border-color: #17a2b8;
}

.btn-check:checked + .btn-outline-warning {
    background-color: #ffc107;
    color: black;
    border-color: #ffc107;
}

.btn-check:checked + .btn-outline-danger {
    background-color: #dc3545;
    color: white;
    border-color: #dc3545;
}

.btn-check:checked + .btn-outline-dark {
    background-color: #343a40;
    color: white;
    border-color: #343a40;
}

/* New colors for checked status buttons */
.btn-check:checked + .bg-young {
    background-color: #007bff;
    color: white;
    border-color: #007bff;
}

.btn-check:checked + .bg-senior {
    background-color: #28a745;
    color: white;
    border-color: #28a745;
}

.btn-check:checked + .bg-traveler {
    background-color: #17a2b8;
    color: white;
    border-color: #17a2b8;
}

.btn-check:checked + .bg-tech {
    background-color: #ffc107;
    color: black;
    border-color: #ffc107;
}

.btn-check:checked + .bg-pets {
    background-color: #dc3545;
    color: white;
    border-color: #dc3545;
}

.btn-check:checked + .bg-fitness {
    background-color: #fd7e14;
    color: white;
    border-color: #fd7e14;
}

.btn-check:checked + .bg-remote {
    background-color: #6610f2;
    color: white;
    border-color: #6610f2;
}

.btn-check:checked + .bg-family {
    background-color: #e83e8c;
    color: white;
    border-color: #e83e8c;
}

.btn-check:checked + .bg-retiree {
    background-color: #9acd32;
    color: white;
    border-color: #9acd32;
}

.btn-check:checked + .bg-single {
    background-color: #40e0d0;
    color: black;
    border-color: #40e0d0;
}

.btn-check:checked + .bg-renter {
    background-color: #ff8c00;
    color: white;
    border-color: #ff8c00;
}

.btn-check:checked + .bg-newlywed {
    background-color: #ba55d3;
    color: white;
    border-color: #ba55d3;
}

.btn-check:checked + .bg-military {
    background-color: #b22222;
    color: white;
    border-color: #b22222;
}

.btn-check:checked + .bg-entrepreneur {
    background-color: #f08080;
    color: black;
    border-color: #f08080;
}

.btn-check:checked + .bg-unemployed {
    background-color: #c71585;
    color: white;
    border-color: #c71585;
}

.btn-check:checked + .bg-caregiver {
    background-color: #daa520;
    color: black;
    border-color: #daa520;
}

.btn-check:checked + .bg-digitalnomad {
    background-color: #5f9ea0;
    color: white;
    border-color: #5f9ea0;
}

.btn-check:checked + .bg-firsttimebuyer {
    background-color: #d2691e;
    color: white;
    border-color: #d2691e;
}

.btn-check:checked + .bg-emptynester {
    background-color: #6495ed;
    color: white;
    border-color: #6495ed;
}

/* New colors for checked hobby buttons */
.btn-check:checked + .bg-consumerism {
    background-color: #4b0082;
    color: white;
    border-color: #4b0082;
}

.btn-check:checked + .bg-travel {
    background-color: #ff4500;
    color: white;
    border-color: #ff4500;
}

.btn-check:checked + .bg-culture {
    background-color: #00ffff;
    color: black;
    border-color: #00ffff;
}

.btn-check:checked + .bg-cars {
    background-color: #7fff00;
    color: black;
    border-color: #7fff00;
}

.btn-check:checked + .bg-insurance {
    background-color: #8a2be2;
    color: white;
    border-color: #8a2be2;
}

.btn-check:checked + .bg-finance {
    background-color: #deb887;
    color: black;
    border-color: #deb887;
}

/* Ensure existing hobby colors are also distinct */
.btn-check:checked + .bg-lifestyle {
    background-color: #20b2aa;
    color: white;
    border-color: #20b2aa;
}

.btn-check:checked + .bg-electronics {
    background-color: #0dcaf0;
    color: white;
    border-color: #0dcaf0;
}

.btn-check:checked + .bg-home {
    background-color: #ff6347;
    color: white;
    border-color: #ff6347;
}

.btn-check:checked + .bg-books {
    background-color: #4682b4;
    color: white;
    border-color: #4682b4;
}

</style>
