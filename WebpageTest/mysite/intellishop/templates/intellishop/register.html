{% extends 'intellishop/index_home_original.html' %}
{% load static %}

{% block content %}
<!-- Registration Form Section -->
<section class="py-5" style="background-color: #f8f9fa;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-7">
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-4">
                        <h2 class="text-center mb-4">Register</h2>
                        <form id="registerForm">
                            {% csrf_token %}
                            <div class="mb-3 row">
                                <label for="username" class="col-sm-3 col-form-label">Username:</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="username" name="username" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="password" class="col-sm-3 col-form-label">Password:</label>
                                <div class="col-sm-9">
                                    <input type="password" class="form-control" id="password" name="password" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="email" class="col-sm-3 col-form-label">Email:</label>
                                <div class="col-sm-9">
                                    <input type="email" class="form-control" id="email" name="email" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="status" class="col-sm-3 col-form-label">Status:</label>
                                <div class="col-sm-9">
                                    <div class="d-flex flex-wrap gap-2">
                                        <input type="checkbox" class="btn-check status-checkbox" id="status-young" value="Young" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-primary rounded-pill" for="status-young">Young</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-senior" value="Senior" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-success rounded-pill" for="status-senior">Senior</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-homeowner" value="Homeowner" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-secondary rounded-pill" for="status-homeowner">Homeowner</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-traveler" value="Traveler" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-info rounded-pill" for="status-traveler">Traveler</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-tech" value="Tech" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-warning rounded-pill" for="status-tech">Tech</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-pets" value="Pets" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-danger rounded-pill" for="status-pets">Pets</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-fitness" value="Fitness" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-primary rounded-pill" for="status-fitness">Fitness</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-student" value="Student" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-success rounded-pill" for="status-student">Student</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-remote" value="Remote" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-dark rounded-pill" for="status-remote">Remote</label>

                                        <input type="checkbox" class="btn-check status-checkbox" id="status-family" value="Family" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-warning rounded-pill" for="status-family">Family</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="age" class="col-sm-3 col-form-label">Age:</label>
                                <div class="col-sm-9">
                                    <input type="number" class="form-control" id="age" name="age" min="18" required>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="location" class="col-sm-3 col-form-label">Location:</label>
                                <div class="col-sm-9">
                                    <select class="form-select" id="location" name="location" required>
                                        <option value="">Select location</option>
                                        <option value="newyork">New York</option>
                                        <option value="sydney">Sydney</option>
                                        <option value="london">London</option>
                                        <option value="mumbai">Mumbai</option>
                                        <option value="toronto">Toronto</option>
                                        <option value="dubai">Dubai</option>
                                        <option value="hongkong">Hong Kong</option>
                                        <option value="shanghai">Shanghai</option>
                                        <option value="israel">Israel</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-3 row">
                                <label for="hobbies" class="col-sm-3 col-form-label">Hobbies:</label>
                                <div class="col-sm-9">
                                    <div class="d-flex flex-wrap gap-2">
                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-Lifestyle" value="lifestyle" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-primary rounded-pill" for="hobby-Lifestyle">Lifestyle & Personal Needs</label>
                                        
                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-home" value="home" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-success rounded-pill" for="hobby-home">Home & Garden</label>
                                        
                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-electronics" value="electronics" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-info rounded-pill" for="hobby-electronics">Electronics</label>
                                        
                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-books" value="books" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-warning rounded-pill" for="hobby-books">Books & Entertainment</label>

                                        <!-- Adding new hobby options -->
                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-consumerism" value="Consumerism" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-danger rounded-pill" for="hobby-consumerism">Consumerism</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-travel" value="Travel and Vacation" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-primary rounded-pill" for="hobby-travel">Travel and Vacation</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-culture" value="Culture and Leisure" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-success rounded-pill" for="hobby-culture">Culture and Leisure</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-cars" value="Cars" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-info rounded-pill" for="hobby-cars">Cars</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-insurance" value="Insurance" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-warning rounded-pill" for="hobby-insurance">Insurance</label>

                                        <input type="checkbox" class="btn-check hobby-checkbox" id="hobby-finance" value="Finance and Banking" autocomplete="off">
                                        <label class="btn btn-sm btn-outline-danger rounded-pill" for="hobby-finance">Finance and Banking</label>

                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-grid mt-4">
                                <button type="submit" class="btn btn-danger">REGISTER</button>
                            </div>
                            
                            <div class="text-center mt-3">
                                <span>Already have an account? <a href="{% url 'login' %}" id="signin-link">SIGN IN</a></span>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.getElementById('registerForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Get all selected hobbies
    const selectedHobbies = Array.from(document.querySelectorAll('.hobby-checkbox:checked')).map(cb => cb.value);
    
    // Get all selected statuses
    const selectedStatuses = Array.from(document.querySelectorAll('.status-checkbox:checked')).map(cb => cb.value);
    
    // Create the data object
    const formData = {
        username: document.getElementById('username').value,
        password: document.getElementById('password').value,
        email: document.getElementById('email').value,
        status: selectedStatuses,  // Now sending array of statuses
        age: parseInt(document.getElementById('age').value),
        location: document.getElementById('location').value,
        hobbies: selectedHobbies
    };

    try {
        const response = await fetch('/register/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            },
            body: JSON.stringify(formData)
        });

        const data = await response.json();
        
        if (response.ok) {
            alert('Registration successful!');
            window.location.href = '/login/';  // Redirect to login page
        } else {
            alert('Error: ' + data.message);
        }
    } catch (error) {
        alert('Error: ' + error.message);
    }
});
</script>
{% endblock %}
